# üõ†Ô∏è Developer Guide: Dance Loop Gen

## Overview
Dance Loop Gen is a modular, service-oriented system designed to automate the production of high-quality AI dance video content. It leverages Gemini's "Thinking Mode" for high-reasoning planning and image generators for visual asset consistency.

---

## üìê Core Architecture
The system follows a **SOLID service-oriented pattern**. Business logic is encapsulated in specialized services, while the `main.py` (CLI) or `web/server.py` (Web) acts as the orchestrator.

### 1. High-Reasoning Planning (Director)
- **Service**: `DirectorService`
- **Purpose**: Plans narrative, looping logic, and character descriptions.
- **Workflow**: Plans 3 scenes with strict loop logic (Scene 3 must loop back to Scene 1).
- **Output**: Structured `VideoPlan`.

### 2. Physical Consistency (Cinematographer)
- **Service**: `CinematographerService`
- **Purpose**: Generates consistent visual anchors (keyframes) using conversational editing.
- **Workflow**:
    1. **Keyframe A** (Master Shot): Generated based on the scene description and optional reference pose.
    2. **Keyframe B/C**: Generated by asking the AI to "edit" the previous frame, maintaining dancer identity and clothing consistency.

### 3. Audience Awareness (SEO Specialist)
- **Service**: `SEOSpecialistService`
- **Purpose**: Generates 3 emotionally-targeted metadata alternatives (titles, descriptions, hashtags) using different "hooks" (Nostalgic, Aspirational, Community).

---

## üìÅ Project Structure
- **`main.py`**: CLI entry point.
- **`services/`**: logic for Director, Cinematographer, SEO, etc.
- **`core/`**: Pydantic data models and interfaces.
- **`utils/`**: Helper modules for logging, CSV, and config.
- **`prompts/`**: Text templates for AI instructions.
- **`web/`**: FastAPI backend and Vanilla JS frontend.

---

## üîÑ Orchestration Pattern
The system follows a rigid pipeline:
1. **Plan**: `Director` produces the scene sequence.
2. **Keyframes**: `Cinematographer` generates visual anchors.
3. **Instructions**: `VeoService` combines plans and keyframes.
4. **SEO**: `SEOSpecialist` completes the package with metadata.

---

## üß™ Testing and Observability
- **Logging**: Multi-level logging with console (INFO) and file (DEBUG) targets in the `logs/` directory.
- **Debug Mode**: The orchestrator saves raw AI responses to `logs/state/` for post-run analysis.

---

## üöÄ Adding New Services
To add a new service:
1. Define any new data models in `core/models.py`.
2. Implement the service in `services/`.
3. Wire the service into the orchestration logic in `VideoProcessor` (if used) or `main.py`.
